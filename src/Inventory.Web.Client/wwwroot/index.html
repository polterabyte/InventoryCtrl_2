<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inventory.Web.Client</title>
    <base href="/" />
    <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/design-system.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="Inventory.Web.Client.styles.css" rel="stylesheet" />
</head>

<body>
    <div id="app">
        <svg class="loading-progress">
            <circle r="40%" cx="50%" cy="50%" />
            <circle r="40%" cx="50%" cy="50%" />
        </svg>
        <div class="loading-progress-text"></div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="." class="reload">Reload</a>
        <span class="dismiss">ðŸ—™</span>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="https://unpkg.com/@microsoft/signalr@latest/dist/browser/signalr.min.js"></script>
    <script src="js/api-config.js"></script>
    <script src="js/signalr-notifications.js"></script>
    <script src="js/push-notifications.js"></script>
    
    <script>
        // JWT Token validation function
        window.isJwtTokenExpired = function(token) {
            try {
                if (!token) return true;
                
                // Split the token into parts
                const parts = token.split('.');
                if (parts.length !== 3) return true;
                
                // Decode the payload (second part)
                const payload = parts[1];
                // Add padding if needed
                const paddedPayload = payload + '='.repeat((4 - payload.length % 4) % 4);
                const decodedPayload = atob(paddedPayload);
                const payloadObj = JSON.parse(decodedPayload);
                
                // Check if token has expiration claim
                if (!payloadObj.exp) return true;
                
                // Get current time in seconds
                const currentTime = Math.floor(Date.now() / 1000);
                
                // Check if token is expired (with 5 minute buffer)
                const bufferTime = 5 * 60; // 5 minutes in seconds
                return payloadObj.exp < (currentTime + bufferTime);
            } catch (error) {
                console.error('Error checking JWT token expiration:', error);
                return true; // If we can't parse, assume expired
            }
        };
    </script>
</body>

</html>



