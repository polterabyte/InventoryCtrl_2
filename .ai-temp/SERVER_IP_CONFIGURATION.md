# Конфигурация IP адреса сервера

## Обзор
Система теперь поддерживает централизованную настройку IP адреса сервера через переменную окружения `SERVER_IP`.

## Настройка IP адреса

### 1. Через переменные окружения
Установите переменную окружения `SERVER_IP`:
```bash
export SERVER_IP=192.168.139.96
```

### 2. Через файл .env
Создайте файл `.env` на основе `env.example`:
```bash
cp env.example .env
```
Затем отредактируйте `.env` и установите:
```
SERVER_IP=192.168.139.96
```

### 3. Через PowerShell скрипт
Используйте скрипт для автоматического обновления:
```powershell
.\update-server-ip.ps1 -NewIP "192.168.139.96"
```

## Что обновляется автоматически

1. **Nginx конфигурация** - server_name и SSL сертификаты
2. **CORS настройки** - добавление IP адреса в разрешенные origins
3. **Docker Compose** - передача переменной в контейнеры
4. **Клиентские конфигурации** - API URLs для всех окружений

## Исправленные проблемы

### POST запросы "Not allowed"
- Добавлен IP адрес в CORS origins
- Настроены правильные CORS headers в nginx
- Обновлена конфигурация API для поддержки IP адреса

### Централизованная конфигурация
- Все файлы теперь используют переменную `SERVER_IP`
- Значение по умолчанию: `192.168.139.96`
- Поддержка fallback значений

## Перезапуск системы

После изменения IP адреса:
```bash
docker-compose down
docker-compose up -d
```

## Проверка конфигурации

1. Проверьте, что nginx использует правильный IP:
```bash
docker logs inventory-nginx-proxy
```

2. Проверьте CORS настройки API:
```bash
curl -H "Origin: http://192.168.139.96" -H "Access-Control-Request-Method: POST" -H "Access-Control-Request-Headers: X-Requested-With" -X OPTIONS http://192.168.139.96/api/
```

3. Проверьте API доступность:
```bash
curl http://192.168.139.96/api/health
```
