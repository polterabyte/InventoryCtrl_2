# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
Write-Host "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏..." -ForegroundColor Yellow

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã dotnet
Write-Host "‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ dotnet..." -ForegroundColor Blue
Get-Process -Name "dotnet" -ErrorAction SilentlyContinue | Stop-Process -Force -ErrorAction SilentlyContinue
Start-Sleep -Seconds 2

# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à —Å–±–æ—Ä–∫–∏
Write-Host "üßπ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —Å–±–æ—Ä–∫–∏..." -ForegroundColor Blue
dotnet clean
dotnet build --no-restore

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã
Write-Host "üì¶ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤..." -ForegroundColor Blue
dotnet restore

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
Write-Host "üî® –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞..." -ForegroundColor Blue
dotnet build

if ($LASTEXITCODE -eq 0) {
    Write-Host "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞!" -ForegroundColor Green
    
    # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    Write-Host "üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π..." -ForegroundColor Green
    Start-Process powershell -ArgumentList "-NoExit", "-Command", "cd '$PSScriptRoot\..'; .\start-apps.ps1"
    
    Write-Host "üéâ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–ø—É—â–µ–Ω—ã! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ http://localhost:5001" -ForegroundColor Green
    Write-Host "üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è:" -ForegroundColor Cyan
    Write-Host "   - –î–æ–±–∞–≤–ª–µ–Ω UseStaticFiles() –≤ API" -ForegroundColor White
    Write-Host "   - –î–æ–±–∞–≤–ª–µ–Ω UseBlazorFrameworkFiles() –≤ API" -ForegroundColor White
    Write-Host "   - –î–æ–±–∞–≤–ª–µ–Ω MapFallbackToFile() –≤ API" -ForegroundColor White
    Write-Host "   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏ –∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º —Ñ–∞–π–ª–∞–º –≤ index.html" -ForegroundColor White
    Write-Host "   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ Blazor WebAssembly Server" -ForegroundColor White
} else {
    Write-Host "Error: Build failed! Check logs above." -ForegroundColor Red
}
